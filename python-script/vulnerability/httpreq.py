import requests
from typing import Optional, Dict, Any

def fetch_json(url: str,
               params: Optional[Dict[str, str]] = None,
               headers: Optional[Dict[str, str]] = None,
               timeout: float = 10.0) -> Dict[str, Any]:
    """
    Faz uma requisição GET para `url` e retorna o JSON decodificado.
    Nunca permite desabilitar a verificação SSL (sempre usa verify=True).
    Levanta TypeError para argumentos inválidos e RequestException para erros de rede/HTTP.
    """
    if not isinstance(url, str):
        raise TypeError("url deve ser uma string")
    if params is not None and not isinstance(params, dict):
        raise TypeError("params deve ser um dict ou None")
    if headers is not None and not isinstance(headers, dict):
        raise TypeError("headers deve ser um dict ou None")
    if not isinstance(timeout, (int, float)):
        raise TypeError("timeout deve ser numérico")

    # verify=True garante que a verificação de certificado TLS não seja desabilitada.
    resp = requests.get(url, params=params, headers=headers, timeout=timeout, verify=True)
    resp.raise_for_status()  # lança HTTPError em códigos de erro
    try:
        return resp.json()
    except ValueError as e:
        raise ValueError("Resposta não contém JSON válido") from e

if __name__ == "__main__":
    # Exemplo de uso
    try:
        data = fetch_json("https://api.github.com", timeout=5)
        print("Sucesso:", list(data.keys()) if isinstance(data, dict) else data)
    except Exception as err:
        print("Erro ao buscar API:", err)